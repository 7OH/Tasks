
&НаКлиенте
Процедура КомандаДобавить(Команда)
	ПараметрыЗакрытия = Новый Структура();
	ПараметрыЗакрытия.Вставить("Комментарий",Комментарий);
	ПараметрыЗакрытия.Вставить("Автор",Автор);
	ПараметрыЗакрытия.Вставить("ДатаКомментария",ДатаКомментария);
	Закрыть(ПараметрыЗакрытия);
КонецПроцедуры

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	Если Параметры.Свойство("ЭтоДобавлениеКомментария") Тогда
		ДатаКомментария = ТекущаяДата();
		Автор = Пользователи.ТекущийПользователь();
		ЭтоДобавлениеКомментария = Истина;
	Иначе
		Комментарий = Параметры.Комментарий;
		Автор = Параметры.Автор;
		ДатаКомментария = Параметры.ДатаКомментария;
	Конецесли;
	УстановитьВидимостьДоступность();
КонецПроцедуры

&НаСервере
Процедура УстановитьВидимостьДоступность()
	ТолькоПросмотр = Истина;
	Элементы.ФормаКомандаДобавить.Видимость = Ложь;
	Если ЭтоДобавлениеКомментария Тогда
		Элементы.ФормаКомандаДобавить.Видимость = Истина;
		ТолькоПросмотр = Ложь;
	Конецесли;
КонецПроцедуры 